<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1" />
<meta name="generator" content="pdoc 0.10.0" />
<title>ogr.services.pagure.pull_request API documentation</title>
<meta name="description" content="" />
<link rel="preload stylesheet" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/10up-sanitize.css/11.0.1/sanitize.min.css" integrity="sha256-PK9q560IAAa6WVRRh76LtCaI8pjTJ2z11v0miyNNjrs=" crossorigin>
<link rel="preload stylesheet" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/10up-sanitize.css/11.0.1/typography.min.css" integrity="sha256-7l/o7C8jubJiy74VsKTidCy1yBkRtiUGbVkYBylBqUg=" crossorigin>
<link rel="stylesheet preload" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.1.1/styles/github.min.css" crossorigin>
<style>:root{--highlight-color:#fe9}.flex{display:flex !important}body{line-height:1.5em}#content{padding:20px}#sidebar{padding:30px;overflow:hidden}#sidebar > *:last-child{margin-bottom:2cm}.http-server-breadcrumbs{font-size:130%;margin:0 0 15px 0}#footer{font-size:.75em;padding:5px 30px;border-top:1px solid #ddd;text-align:right}#footer p{margin:0 0 0 1em;display:inline-block}#footer p:last-child{margin-right:30px}h1,h2,h3,h4,h5{font-weight:300}h1{font-size:2.5em;line-height:1.1em}h2{font-size:1.75em;margin:1em 0 .50em 0}h3{font-size:1.4em;margin:25px 0 10px 0}h4{margin:0;font-size:105%}h1:target,h2:target,h3:target,h4:target,h5:target,h6:target{background:var(--highlight-color);padding:.2em 0}a{color:#058;text-decoration:none;transition:color .3s ease-in-out}a:hover{color:#e82}.title code{font-weight:bold}h2[id^="header-"]{margin-top:2em}.ident{color:#900}pre code{background:#f8f8f8;font-size:.8em;line-height:1.4em}code{background:#f2f2f1;padding:1px 4px;overflow-wrap:break-word}h1 code{background:transparent}pre{background:#f8f8f8;border:0;border-top:1px solid #ccc;border-bottom:1px solid #ccc;margin:1em 0;padding:1ex}#http-server-module-list{display:flex;flex-flow:column}#http-server-module-list div{display:flex}#http-server-module-list dt{min-width:10%}#http-server-module-list p{margin-top:0}.toc ul,#index{list-style-type:none;margin:0;padding:0}#index code{background:transparent}#index h3{border-bottom:1px solid #ddd}#index ul{padding:0}#index h4{margin-top:.6em;font-weight:bold}@media (min-width:200ex){#index .two-column{column-count:2}}@media (min-width:300ex){#index .two-column{column-count:3}}dl{margin-bottom:2em}dl dl:last-child{margin-bottom:4em}dd{margin:0 0 1em 3em}#header-classes + dl > dd{margin-bottom:3em}dd dd{margin-left:2em}dd p{margin:10px 0}.name{background:#eee;font-weight:bold;font-size:.85em;padding:5px 10px;display:inline-block;min-width:40%}.name:hover{background:#e0e0e0}dt:target .name{background:var(--highlight-color)}.name > span:first-child{white-space:nowrap}.name.class > span:nth-child(2){margin-left:.4em}.inherited{color:#999;border-left:5px solid #eee;padding-left:1em}.inheritance em{font-style:normal;font-weight:bold}.desc h2{font-weight:400;font-size:1.25em}.desc h3{font-size:1em}.desc dt code{background:inherit}.source summary,.git-link-div{color:#666;text-align:right;font-weight:400;font-size:.8em;text-transform:uppercase}.source summary > *{white-space:nowrap;cursor:pointer}.git-link{color:inherit;margin-left:1em}.source pre{max-height:500px;overflow:auto;margin:0}.source pre code{font-size:12px;overflow:visible}.hlist{list-style:none}.hlist li{display:inline}.hlist li:after{content:',\2002'}.hlist li:last-child:after{content:none}.hlist .hlist{display:inline;padding-left:1em}img{max-width:100%}td{padding:0 .5em}.admonition{padding:.1em .5em;margin-bottom:1em}.admonition-title{font-weight:bold}.admonition.note,.admonition.info,.admonition.important{background:#aef}.admonition.todo,.admonition.versionadded,.admonition.tip,.admonition.hint{background:#dfd}.admonition.warning,.admonition.versionchanged,.admonition.deprecated{background:#fd4}.admonition.error,.admonition.danger,.admonition.caution{background:lightpink}</style>
<style media="screen and (min-width: 700px)">@media screen and (min-width:700px){#sidebar{width:30%;height:100vh;overflow:auto;position:sticky;top:0}#content{width:70%;max-width:100ch;padding:3em 4em;border-left:1px solid #ddd}pre code{font-size:1em}.item .name{font-size:1em}main{display:flex;flex-direction:row-reverse;justify-content:flex-end}.toc ul ul,#index ul{padding-left:1.5em}.toc > ul > li{margin-top:.5em}}</style>
<style media="print">@media print{#sidebar h1{page-break-before:always}.source{display:none}}@media print{*{background:transparent !important;color:#000 !important;box-shadow:none !important;text-shadow:none !important}a[href]:after{content:" (" attr(href) ")";font-size:90%}a[href][title]:after{content:none}abbr[title]:after{content:" (" attr(title) ")"}.ir a:after,a[href^="javascript:"]:after,a[href^="#"]:after{content:""}pre,blockquote{border:1px solid #999;page-break-inside:avoid}thead{display:table-header-group}tr,img{page-break-inside:avoid}img{max-width:100% !important}@page{margin:0.5cm}p,h2,h3{orphans:3;widows:3}h1,h2,h3,h4,h5,h6{page-break-after:avoid}}</style>
<script defer src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.1.1/highlight.min.js" integrity="sha256-Uv3H6lx7dJmRfRvH8TH6kJD1TSK1aFcwgx+mdg3epi8=" crossorigin></script>
<script>window.addEventListener('DOMContentLoaded', () => hljs.initHighlighting())</script>
</head>
<body>
<main>
<article id="content">
<header>
<h1 class="title">Module <code>ogr.services.pagure.pull_request</code></h1>
</header>
<section id="section-intro">
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python"># Copyright Contributors to the Packit project.
# SPDX-License-Identifier: MIT

import datetime
import logging
from typing import List, Optional, Dict, Any, Union

from ogr.abstract import PRStatus, CommitFlag, CommitStatus
from ogr.abstract import PullRequest, PRComment
from ogr.exceptions import PagureAPIException
from ogr.services import pagure as ogr_pagure
from ogr.services.base import BasePullRequest
from ogr.services.pagure.comments import PagurePRComment

logger = logging.getLogger(__name__)


class PagurePullRequest(BasePullRequest):
    _target_project: &#34;ogr_pagure.PagureProject&#34;
    _source_project: &#34;ogr_pagure.PagureProject&#34; = None

    def __init__(self, raw_pr, project):
        super().__init__(raw_pr, project)
        self.__dirty = False

    def __update(self):
        if self.__dirty:
            self._raw_pr = self.__call_api()
            self.__dirty = False

    @property
    def title(self) -&gt; str:
        self.__update()
        return self._raw_pr[&#34;title&#34;]

    @title.setter
    def title(self, new_title: str) -&gt; None:
        self.update_info(title=new_title)

    @property
    def id(self) -&gt; int:
        return self._raw_pr[&#34;id&#34;]

    @property
    def status(self) -&gt; PRStatus:
        self.__update()
        return PRStatus[self._raw_pr[&#34;status&#34;].lower()]

    @property
    def url(self) -&gt; str:
        return &#34;/&#34;.join(
            [
                self.target_project.service.instance_url,
                self._raw_pr[&#34;project&#34;][&#34;url_path&#34;],
                &#34;pull-request&#34;,
                str(self.id),
            ]
        )

    @property
    def description(self) -&gt; str:
        self.__update()
        return self._raw_pr[&#34;initial_comment&#34;]

    @description.setter
    def description(self, new_description: str) -&gt; None:
        self.update_info(description=new_description)

    @property
    def author(self) -&gt; str:
        return self._raw_pr[&#34;user&#34;][&#34;name&#34;]

    @property
    def source_branch(self) -&gt; str:
        return self._raw_pr[&#34;branch_from&#34;]

    @property
    def target_branch(self) -&gt; str:
        return self._raw_pr[&#34;branch&#34;]

    @property
    def created(self) -&gt; datetime.datetime:
        return datetime.datetime.fromtimestamp(int(self._raw_pr[&#34;date_created&#34;]))

    @property
    def diff_url(self) -&gt; str:
        return f&#34;{self.url}#request_diff&#34;

    @property
    def commits_url(self) -&gt; str:
        return f&#34;{self.url}#commit_list&#34;

    @property
    def patch(self) -&gt; bytes:
        request_response = self._target_project._call_project_api_raw(
            &#34;pull-request&#34;, f&#34;{self.id}.patch&#34;, add_api_endpoint_part=False
        )
        if request_response.status_code != 200:
            raise PagureAPIException(
                f&#34;Cannot get patch from {self.url}.patch because {request_response.reason}.&#34;,
                response_code=request_response.status_code,
            )
        return request_response.content

    @property
    def head_commit(self) -&gt; str:
        return self._raw_pr[&#34;commit_stop&#34;]

    @property
    def source_project(self) -&gt; &#34;ogr_pagure.PagureProject&#34;:
        if self._source_project is None:
            source = self._raw_pr[&#34;repo_from&#34;]
            source_project_info = {
                &#34;repo&#34;: source[&#34;name&#34;],
                &#34;namespace&#34;: source[&#34;namespace&#34;],
            }

            if source[&#34;parent&#34;] is not None:
                source_project_info[&#34;is_fork&#34;] = True
                source_project_info[&#34;username&#34;] = source[&#34;user&#34;][&#34;name&#34;]

            self._source_project = self._target_project.service.get_project(
                **source_project_info
            )

        return self._source_project

    @property
    def closed_by(self) -&gt; Optional[str]:
        closed_by = self._raw_pr[&#34;closed_by&#34;]
        return closed_by[&#34;name&#34;] if closed_by else None

    def __str__(self) -&gt; str:
        return &#34;Pagure&#34; + super().__str__()

    def __call_api(self, *args, **kwargs) -&gt; dict:
        return self._target_project._call_project_api(
            &#34;pull-request&#34;, str(self.id), *args, **kwargs
        )

    @staticmethod
    def create(
        project: &#34;ogr_pagure.PagureProject&#34;,
        title: str,
        body: str,
        target_branch: str,
        source_branch: str,
        fork_username: str = None,
    ) -&gt; &#34;PullRequest&#34;:
        data = {
            &#34;title&#34;: title,
            &#34;branch_to&#34;: target_branch,
            &#34;branch_from&#34;: source_branch,
            &#34;initial_comment&#34;: body,
        }

        caller = project
        if project.is_fork:
            data[&#34;repo_from&#34;] = project.repo
            data[&#34;repo_from_username&#34;] = project._user
            data[&#34;repo_from_namespace&#34;] = project.namespace

            # running the call from the parent project
            caller = caller.parent
        elif fork_username:
            fork_project = project.service.get_project(
                username=fork_username,
                repo=project.repo,
                namespace=project.namespace,
                is_fork=True,
            )
            data[&#34;repo_from_username&#34;] = fork_username
            data[&#34;repo_from&#34;] = fork_project.repo
            data[&#34;repo_from_namespace&#34;] = fork_project.namespace

        response = caller._call_project_api(
            &#34;pull-request&#34;, &#34;new&#34;, method=&#34;POST&#34;, data=data
        )
        return PagurePullRequest(response, caller)

    @staticmethod
    def get(project: &#34;ogr_pagure.PagureProject&#34;, pr_id: int) -&gt; &#34;PullRequest&#34;:
        raw_pr = project._call_project_api(&#34;pull-request&#34;, str(pr_id))
        return PagurePullRequest(raw_pr, project)

    @staticmethod
    def get_list(
        project: &#34;ogr_pagure.PagureProject&#34;,
        status: PRStatus = PRStatus.open,
        assignee=None,
        author=None,
    ) -&gt; List[&#34;PullRequest&#34;]:
        payload = {&#34;page&#34;: 1, &#34;status&#34;: status.name.capitalize()}
        if assignee is not None:
            payload[&#34;assignee&#34;] = assignee
        if author is not None:
            payload[&#34;author&#34;] = author

        raw_prs = []
        while True:
            page_result = project._call_project_api(&#34;pull-requests&#34;, params=payload)
            raw_prs += page_result[&#34;requests&#34;]
            if not page_result[&#34;pagination&#34;][&#34;next&#34;]:
                break

            # mypy don&#39;t know that key &#34;page&#34; really contains int...
            payload[&#34;page&#34;] += 1  # type: ignore

        return [PagurePullRequest(pr_dict, project) for pr_dict in raw_prs]

    def update_info(
        self, title: Optional[str] = None, description: Optional[str] = None
    ) -&gt; &#34;PullRequest&#34;:
        try:
            data = {&#34;title&#34;: title if title else self.title}

            if description:
                data[&#34;initial_comment&#34;] = description

            updated_pr = self.__call_api(method=&#34;POST&#34;, data=data)
            logger.info(&#34;PR updated.&#34;)

            self._raw_pr = updated_pr
            return self
        except Exception as ex:
            raise PagureAPIException(&#34;there was an error while updating the PR&#34;) from ex

    def _get_all_comments(self) -&gt; List[PRComment]:
        self.__update()
        raw_comments = self._raw_pr[&#34;comments&#34;]
        return [
            PagurePRComment(parent=self, raw_comment=comment_dict)
            for comment_dict in raw_comments
        ]

    def comment(
        self,
        body: str,
        commit: Optional[str] = None,
        filename: Optional[str] = None,
        row: Optional[int] = None,
    ) -&gt; &#34;PRComment&#34;:
        payload: Dict[str, Any] = {&#34;comment&#34;: body}
        if commit is not None:
            payload[&#34;commit&#34;] = commit
        if filename is not None:
            payload[&#34;filename&#34;] = filename
        if row is not None:
            payload[&#34;row&#34;] = row

        self.__call_api(&#34;comment&#34;, method=&#34;POST&#34;, data=payload)
        self.__dirty = True
        return PagurePRComment(
            parent=self,
            body=body,
            author=self.target_project.service.user.get_username(),
        )

    def close(self) -&gt; &#34;PullRequest&#34;:
        return_value = self.__call_api(&#34;close&#34;, method=&#34;POST&#34;)

        if return_value[&#34;message&#34;] != &#34;Pull-request closed!&#34;:
            raise PagureAPIException(return_value[&#34;message&#34;])

        self.__dirty = True
        return self

    def merge(self) -&gt; &#34;PullRequest&#34;:
        return_value = self.__call_api(&#34;merge&#34;, method=&#34;POST&#34;)

        if return_value[&#34;message&#34;] != &#34;Changes merged!&#34;:
            raise PagureAPIException(return_value[&#34;message&#34;])

        self.__dirty = True
        return self

    def get_statuses(self) -&gt; List[CommitFlag]:
        self.__update()
        return self.target_project.get_commit_statuses(self._raw_pr[&#34;commit_stop&#34;])

    def set_flag(
        self,
        username: str,
        comment: str,
        url: str,
        status: Optional[CommitStatus] = None,
        percent: Optional[int] = None,
        uid: Optional[str] = None,
    ) -&gt; dict:
        &#34;&#34;&#34;
        Set a flag on a pull-request to display results or status of CI tasks.

        See &#34;Flag a pull-request&#34; at https://pagure.io/api/0/#pull_requests-tab
        for a full description of the parameters.

        Args:
            username: The name of the application to be presented to users
                on the pull request page.
            comment: A short message summarizing the presented results.
            url: A URL to the result of this flag.
            status: The status to be displayed for this flag.
            percent: A percentage of completion compared to the goal.
            uid: A unique identifier used to identify a flag on the pull-request.

        Returns:
            Dictionary with the response received from Pagure.
        &#34;&#34;&#34;
        data: Dict[str, Union[str, int]] = {
            &#34;username&#34;: username,
            &#34;comment&#34;: comment,
            &#34;url&#34;: url,
        }
        if status is not None:
            data[&#34;status&#34;] = status.name
        if percent is not None:
            data[&#34;percent&#34;] = percent
        if uid is not None:
            data[&#34;uid&#34;] = uid
        return self.__call_api(&#34;flag&#34;, method=&#34;POST&#34;, data=data)

    def get_comment(self, comment_id: int) -&gt; PRComment:
        for comment in self._get_all_comments():
            if comment.id == comment_id:
                return comment

        raise PagureAPIException(
            f&#34;No comment with id#{comment_id} in PR#{self.id} found.&#34;, response_code=404
        )</code></pre>
</details>
</section>
<section>
</section>
<section>
</section>
<section>
</section>
<section>
<h2 class="section-title" id="header-classes">Classes</h2>
<dl>
<dt id="ogr.services.pagure.pull_request.PagurePullRequest"><code class="flex name class">
<span>class <span class="ident">PagurePullRequest</span></span>
<span>(</span><span>raw_pr, project)</span>
</code></dt>
<dd>
<div class="desc"><h2 id="attributes">Attributes</h2>
<dl>
<dt><strong><code>project</code></strong> :&ensp;<code>GitProject</code></dt>
<dd>Project of the pull request.</dd>
</dl></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">class PagurePullRequest(BasePullRequest):
    _target_project: &#34;ogr_pagure.PagureProject&#34;
    _source_project: &#34;ogr_pagure.PagureProject&#34; = None

    def __init__(self, raw_pr, project):
        super().__init__(raw_pr, project)
        self.__dirty = False

    def __update(self):
        if self.__dirty:
            self._raw_pr = self.__call_api()
            self.__dirty = False

    @property
    def title(self) -&gt; str:
        self.__update()
        return self._raw_pr[&#34;title&#34;]

    @title.setter
    def title(self, new_title: str) -&gt; None:
        self.update_info(title=new_title)

    @property
    def id(self) -&gt; int:
        return self._raw_pr[&#34;id&#34;]

    @property
    def status(self) -&gt; PRStatus:
        self.__update()
        return PRStatus[self._raw_pr[&#34;status&#34;].lower()]

    @property
    def url(self) -&gt; str:
        return &#34;/&#34;.join(
            [
                self.target_project.service.instance_url,
                self._raw_pr[&#34;project&#34;][&#34;url_path&#34;],
                &#34;pull-request&#34;,
                str(self.id),
            ]
        )

    @property
    def description(self) -&gt; str:
        self.__update()
        return self._raw_pr[&#34;initial_comment&#34;]

    @description.setter
    def description(self, new_description: str) -&gt; None:
        self.update_info(description=new_description)

    @property
    def author(self) -&gt; str:
        return self._raw_pr[&#34;user&#34;][&#34;name&#34;]

    @property
    def source_branch(self) -&gt; str:
        return self._raw_pr[&#34;branch_from&#34;]

    @property
    def target_branch(self) -&gt; str:
        return self._raw_pr[&#34;branch&#34;]

    @property
    def created(self) -&gt; datetime.datetime:
        return datetime.datetime.fromtimestamp(int(self._raw_pr[&#34;date_created&#34;]))

    @property
    def diff_url(self) -&gt; str:
        return f&#34;{self.url}#request_diff&#34;

    @property
    def commits_url(self) -&gt; str:
        return f&#34;{self.url}#commit_list&#34;

    @property
    def patch(self) -&gt; bytes:
        request_response = self._target_project._call_project_api_raw(
            &#34;pull-request&#34;, f&#34;{self.id}.patch&#34;, add_api_endpoint_part=False
        )
        if request_response.status_code != 200:
            raise PagureAPIException(
                f&#34;Cannot get patch from {self.url}.patch because {request_response.reason}.&#34;,
                response_code=request_response.status_code,
            )
        return request_response.content

    @property
    def head_commit(self) -&gt; str:
        return self._raw_pr[&#34;commit_stop&#34;]

    @property
    def source_project(self) -&gt; &#34;ogr_pagure.PagureProject&#34;:
        if self._source_project is None:
            source = self._raw_pr[&#34;repo_from&#34;]
            source_project_info = {
                &#34;repo&#34;: source[&#34;name&#34;],
                &#34;namespace&#34;: source[&#34;namespace&#34;],
            }

            if source[&#34;parent&#34;] is not None:
                source_project_info[&#34;is_fork&#34;] = True
                source_project_info[&#34;username&#34;] = source[&#34;user&#34;][&#34;name&#34;]

            self._source_project = self._target_project.service.get_project(
                **source_project_info
            )

        return self._source_project

    @property
    def closed_by(self) -&gt; Optional[str]:
        closed_by = self._raw_pr[&#34;closed_by&#34;]
        return closed_by[&#34;name&#34;] if closed_by else None

    def __str__(self) -&gt; str:
        return &#34;Pagure&#34; + super().__str__()

    def __call_api(self, *args, **kwargs) -&gt; dict:
        return self._target_project._call_project_api(
            &#34;pull-request&#34;, str(self.id), *args, **kwargs
        )

    @staticmethod
    def create(
        project: &#34;ogr_pagure.PagureProject&#34;,
        title: str,
        body: str,
        target_branch: str,
        source_branch: str,
        fork_username: str = None,
    ) -&gt; &#34;PullRequest&#34;:
        data = {
            &#34;title&#34;: title,
            &#34;branch_to&#34;: target_branch,
            &#34;branch_from&#34;: source_branch,
            &#34;initial_comment&#34;: body,
        }

        caller = project
        if project.is_fork:
            data[&#34;repo_from&#34;] = project.repo
            data[&#34;repo_from_username&#34;] = project._user
            data[&#34;repo_from_namespace&#34;] = project.namespace

            # running the call from the parent project
            caller = caller.parent
        elif fork_username:
            fork_project = project.service.get_project(
                username=fork_username,
                repo=project.repo,
                namespace=project.namespace,
                is_fork=True,
            )
            data[&#34;repo_from_username&#34;] = fork_username
            data[&#34;repo_from&#34;] = fork_project.repo
            data[&#34;repo_from_namespace&#34;] = fork_project.namespace

        response = caller._call_project_api(
            &#34;pull-request&#34;, &#34;new&#34;, method=&#34;POST&#34;, data=data
        )
        return PagurePullRequest(response, caller)

    @staticmethod
    def get(project: &#34;ogr_pagure.PagureProject&#34;, pr_id: int) -&gt; &#34;PullRequest&#34;:
        raw_pr = project._call_project_api(&#34;pull-request&#34;, str(pr_id))
        return PagurePullRequest(raw_pr, project)

    @staticmethod
    def get_list(
        project: &#34;ogr_pagure.PagureProject&#34;,
        status: PRStatus = PRStatus.open,
        assignee=None,
        author=None,
    ) -&gt; List[&#34;PullRequest&#34;]:
        payload = {&#34;page&#34;: 1, &#34;status&#34;: status.name.capitalize()}
        if assignee is not None:
            payload[&#34;assignee&#34;] = assignee
        if author is not None:
            payload[&#34;author&#34;] = author

        raw_prs = []
        while True:
            page_result = project._call_project_api(&#34;pull-requests&#34;, params=payload)
            raw_prs += page_result[&#34;requests&#34;]
            if not page_result[&#34;pagination&#34;][&#34;next&#34;]:
                break

            # mypy don&#39;t know that key &#34;page&#34; really contains int...
            payload[&#34;page&#34;] += 1  # type: ignore

        return [PagurePullRequest(pr_dict, project) for pr_dict in raw_prs]

    def update_info(
        self, title: Optional[str] = None, description: Optional[str] = None
    ) -&gt; &#34;PullRequest&#34;:
        try:
            data = {&#34;title&#34;: title if title else self.title}

            if description:
                data[&#34;initial_comment&#34;] = description

            updated_pr = self.__call_api(method=&#34;POST&#34;, data=data)
            logger.info(&#34;PR updated.&#34;)

            self._raw_pr = updated_pr
            return self
        except Exception as ex:
            raise PagureAPIException(&#34;there was an error while updating the PR&#34;) from ex

    def _get_all_comments(self) -&gt; List[PRComment]:
        self.__update()
        raw_comments = self._raw_pr[&#34;comments&#34;]
        return [
            PagurePRComment(parent=self, raw_comment=comment_dict)
            for comment_dict in raw_comments
        ]

    def comment(
        self,
        body: str,
        commit: Optional[str] = None,
        filename: Optional[str] = None,
        row: Optional[int] = None,
    ) -&gt; &#34;PRComment&#34;:
        payload: Dict[str, Any] = {&#34;comment&#34;: body}
        if commit is not None:
            payload[&#34;commit&#34;] = commit
        if filename is not None:
            payload[&#34;filename&#34;] = filename
        if row is not None:
            payload[&#34;row&#34;] = row

        self.__call_api(&#34;comment&#34;, method=&#34;POST&#34;, data=payload)
        self.__dirty = True
        return PagurePRComment(
            parent=self,
            body=body,
            author=self.target_project.service.user.get_username(),
        )

    def close(self) -&gt; &#34;PullRequest&#34;:
        return_value = self.__call_api(&#34;close&#34;, method=&#34;POST&#34;)

        if return_value[&#34;message&#34;] != &#34;Pull-request closed!&#34;:
            raise PagureAPIException(return_value[&#34;message&#34;])

        self.__dirty = True
        return self

    def merge(self) -&gt; &#34;PullRequest&#34;:
        return_value = self.__call_api(&#34;merge&#34;, method=&#34;POST&#34;)

        if return_value[&#34;message&#34;] != &#34;Changes merged!&#34;:
            raise PagureAPIException(return_value[&#34;message&#34;])

        self.__dirty = True
        return self

    def get_statuses(self) -&gt; List[CommitFlag]:
        self.__update()
        return self.target_project.get_commit_statuses(self._raw_pr[&#34;commit_stop&#34;])

    def set_flag(
        self,
        username: str,
        comment: str,
        url: str,
        status: Optional[CommitStatus] = None,
        percent: Optional[int] = None,
        uid: Optional[str] = None,
    ) -&gt; dict:
        &#34;&#34;&#34;
        Set a flag on a pull-request to display results or status of CI tasks.

        See &#34;Flag a pull-request&#34; at https://pagure.io/api/0/#pull_requests-tab
        for a full description of the parameters.

        Args:
            username: The name of the application to be presented to users
                on the pull request page.
            comment: A short message summarizing the presented results.
            url: A URL to the result of this flag.
            status: The status to be displayed for this flag.
            percent: A percentage of completion compared to the goal.
            uid: A unique identifier used to identify a flag on the pull-request.

        Returns:
            Dictionary with the response received from Pagure.
        &#34;&#34;&#34;
        data: Dict[str, Union[str, int]] = {
            &#34;username&#34;: username,
            &#34;comment&#34;: comment,
            &#34;url&#34;: url,
        }
        if status is not None:
            data[&#34;status&#34;] = status.name
        if percent is not None:
            data[&#34;percent&#34;] = percent
        if uid is not None:
            data[&#34;uid&#34;] = uid
        return self.__call_api(&#34;flag&#34;, method=&#34;POST&#34;, data=data)

    def get_comment(self, comment_id: int) -&gt; PRComment:
        for comment in self._get_all_comments():
            if comment.id == comment_id:
                return comment

        raise PagureAPIException(
            f&#34;No comment with id#{comment_id} in PR#{self.id} found.&#34;, response_code=404
        )</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li><a title="ogr.services.base.BasePullRequest" href="../base.html#ogr.services.base.BasePullRequest">BasePullRequest</a></li>
<li><a title="ogr.abstract.PullRequest" href="../../abstract.html#ogr.abstract.PullRequest">PullRequest</a></li>
<li><a title="ogr.abstract.OgrAbstractClass" href="../../abstract.html#ogr.abstract.OgrAbstractClass">OgrAbstractClass</a></li>
</ul>
<h3>Methods</h3>
<dl>
<dt id="ogr.services.pagure.pull_request.PagurePullRequest.set_flag"><code class="name flex">
<span>def <span class="ident">set_flag</span></span>(<span>self, username: str, comment: str, url: str, status: Optional[<a title="ogr.abstract.CommitStatus" href="../../abstract.html#ogr.abstract.CommitStatus">CommitStatus</a>] = None, percent: Optional[int] = None, uid: Optional[str] = None) ‑> dict</span>
</code></dt>
<dd>
<div class="desc"><p>Set a flag on a pull-request to display results or status of CI tasks.</p>
<p>See "Flag a pull-request" at <a href="https://pagure.io/api/0/#pull_requests-tab">https://pagure.io/api/0/#pull_requests-tab</a>
for a full description of the parameters.</p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>username</code></strong></dt>
<dd>The name of the application to be presented to users
on the pull request page.</dd>
<dt><strong><code>comment</code></strong></dt>
<dd>A short message summarizing the presented results.</dd>
<dt><strong><code>url</code></strong></dt>
<dd>A URL to the result of this flag.</dd>
<dt><strong><code>status</code></strong></dt>
<dd>The status to be displayed for this flag.</dd>
<dt><strong><code>percent</code></strong></dt>
<dd>A percentage of completion compared to the goal.</dd>
<dt><strong><code>uid</code></strong></dt>
<dd>A unique identifier used to identify a flag on the pull-request.</dd>
</dl>
<h2 id="returns">Returns</h2>
<p>Dictionary with the response received from Pagure.</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def set_flag(
    self,
    username: str,
    comment: str,
    url: str,
    status: Optional[CommitStatus] = None,
    percent: Optional[int] = None,
    uid: Optional[str] = None,
) -&gt; dict:
    &#34;&#34;&#34;
    Set a flag on a pull-request to display results or status of CI tasks.

    See &#34;Flag a pull-request&#34; at https://pagure.io/api/0/#pull_requests-tab
    for a full description of the parameters.

    Args:
        username: The name of the application to be presented to users
            on the pull request page.
        comment: A short message summarizing the presented results.
        url: A URL to the result of this flag.
        status: The status to be displayed for this flag.
        percent: A percentage of completion compared to the goal.
        uid: A unique identifier used to identify a flag on the pull-request.

    Returns:
        Dictionary with the response received from Pagure.
    &#34;&#34;&#34;
    data: Dict[str, Union[str, int]] = {
        &#34;username&#34;: username,
        &#34;comment&#34;: comment,
        &#34;url&#34;: url,
    }
    if status is not None:
        data[&#34;status&#34;] = status.name
    if percent is not None:
        data[&#34;percent&#34;] = percent
    if uid is not None:
        data[&#34;uid&#34;] = uid
    return self.__call_api(&#34;flag&#34;, method=&#34;POST&#34;, data=data)</code></pre>
</details>
</dd>
</dl>
<h3>Inherited members</h3>
<ul class="hlist">
<li><code><b><a title="ogr.services.base.BasePullRequest" href="../base.html#ogr.services.base.BasePullRequest">BasePullRequest</a></b></code>:
<ul class="hlist">
<li><code><a title="ogr.services.base.BasePullRequest.author" href="../../abstract.html#ogr.abstract.PullRequest.author">author</a></code></li>
<li><code><a title="ogr.services.base.BasePullRequest.close" href="../../abstract.html#ogr.abstract.PullRequest.close">close</a></code></li>
<li><code><a title="ogr.services.base.BasePullRequest.closed_by" href="../../abstract.html#ogr.abstract.PullRequest.closed_by">closed_by</a></code></li>
<li><code><a title="ogr.services.base.BasePullRequest.comment" href="../../abstract.html#ogr.abstract.PullRequest.comment">comment</a></code></li>
<li><code><a title="ogr.services.base.BasePullRequest.commits_url" href="../../abstract.html#ogr.abstract.PullRequest.commits_url">commits_url</a></code></li>
<li><code><a title="ogr.services.base.BasePullRequest.create" href="../../abstract.html#ogr.abstract.PullRequest.create">create</a></code></li>
<li><code><a title="ogr.services.base.BasePullRequest.created" href="../../abstract.html#ogr.abstract.PullRequest.created">created</a></code></li>
<li><code><a title="ogr.services.base.BasePullRequest.description" href="../../abstract.html#ogr.abstract.PullRequest.description">description</a></code></li>
<li><code><a title="ogr.services.base.BasePullRequest.diff_url" href="../../abstract.html#ogr.abstract.PullRequest.diff_url">diff_url</a></code></li>
<li><code><a title="ogr.services.base.BasePullRequest.get" href="../../abstract.html#ogr.abstract.PullRequest.get">get</a></code></li>
<li><code><a title="ogr.services.base.BasePullRequest.get_list" href="../../abstract.html#ogr.abstract.PullRequest.get_list">get_list</a></code></li>
<li><code><a title="ogr.services.base.BasePullRequest.head_commit" href="../../abstract.html#ogr.abstract.PullRequest.head_commit">head_commit</a></code></li>
<li><code><a title="ogr.services.base.BasePullRequest.id" href="../../abstract.html#ogr.abstract.PullRequest.id">id</a></code></li>
<li><code><a title="ogr.services.base.BasePullRequest.merge" href="../../abstract.html#ogr.abstract.PullRequest.merge">merge</a></code></li>
<li><code><a title="ogr.services.base.BasePullRequest.patch" href="../../abstract.html#ogr.abstract.PullRequest.patch">patch</a></code></li>
<li><code><a title="ogr.services.base.BasePullRequest.source_branch" href="../../abstract.html#ogr.abstract.PullRequest.source_branch">source_branch</a></code></li>
<li><code><a title="ogr.services.base.BasePullRequest.source_project" href="../../abstract.html#ogr.abstract.PullRequest.source_project">source_project</a></code></li>
<li><code><a title="ogr.services.base.BasePullRequest.status" href="../../abstract.html#ogr.abstract.PullRequest.status">status</a></code></li>
<li><code><a title="ogr.services.base.BasePullRequest.target_branch" href="../../abstract.html#ogr.abstract.PullRequest.target_branch">target_branch</a></code></li>
<li><code><a title="ogr.services.base.BasePullRequest.title" href="../../abstract.html#ogr.abstract.PullRequest.title">title</a></code></li>
<li><code><a title="ogr.services.base.BasePullRequest.update_info" href="../../abstract.html#ogr.abstract.PullRequest.update_info">update_info</a></code></li>
<li><code><a title="ogr.services.base.BasePullRequest.url" href="../../abstract.html#ogr.abstract.PullRequest.url">url</a></code></li>
</ul>
</li>
<li><code><b><a title="ogr.services.base.BasePullRequest" href="../base.html#ogr.services.base.BasePullRequest">BasePullRequest</a></b></code>:
<ul class="hlist">
<li><code><a title="ogr.services.base.BasePullRequest.add_label" href="../../abstract.html#ogr.abstract.PullRequest.add_label">add_label</a></code></li>
<li><code><a title="ogr.services.base.BasePullRequest.get_all_commits" href="../../abstract.html#ogr.abstract.PullRequest.get_all_commits">get_all_commits</a></code></li>
<li><code><a title="ogr.services.base.BasePullRequest.get_comment" href="../../abstract.html#ogr.abstract.PullRequest.get_comment">get_comment</a></code></li>
<li><code><a title="ogr.services.base.BasePullRequest.labels" href="../../abstract.html#ogr.abstract.PullRequest.labels">labels</a></code></li>
<li><code><a title="ogr.services.base.BasePullRequest.merge_commit_sha" href="../../abstract.html#ogr.abstract.PullRequest.merge_commit_sha">merge_commit_sha</a></code></li>
<li><code><a title="ogr.services.base.BasePullRequest.merge_commit_status" href="../../abstract.html#ogr.abstract.PullRequest.merge_commit_status">merge_commit_status</a></code></li>
<li><code><a title="ogr.services.base.BasePullRequest.target_branch_head_commit" href="../../abstract.html#ogr.abstract.PullRequest.target_branch_head_commit">target_branch_head_commit</a></code></li>
<li><code><a title="ogr.services.base.BasePullRequest.target_project" href="../../abstract.html#ogr.abstract.PullRequest.target_project">target_project</a></code></li>
</ul>
</li>
<li><code><b><a title="ogr.abstract.PullRequest" href="../../abstract.html#ogr.abstract.PullRequest">PullRequest</a></b></code>:
<ul class="hlist">
<li><code><a title="ogr.abstract.PullRequest.get_statuses" href="../../abstract.html#ogr.abstract.PullRequest.get_statuses">get_statuses</a></code></li>
</ul>
</li>
<li><code><b><a title="ogr.abstract.PullRequest" href="../../abstract.html#ogr.abstract.PullRequest">PullRequest</a></b></code>:
<ul class="hlist">
<li><code><a title="ogr.abstract.PullRequest.get_comments" href="../../abstract.html#ogr.abstract.PullRequest.get_comments">get_comments</a></code></li>
<li><code><a title="ogr.abstract.PullRequest.search" href="../../abstract.html#ogr.abstract.PullRequest.search">search</a></code></li>
</ul>
</li>
</ul>
</dd>
</dl>
</section>
</article>
<nav id="sidebar">
<h1>Index</h1>
<div class="toc">
<ul></ul>
</div>
<ul id="index">
<li><h3>Super-module</h3>
<ul>
<li><code><a title="ogr.services.pagure" href="index.html">ogr.services.pagure</a></code></li>
</ul>
</li>
<li><h3><a href="#header-classes">Classes</a></h3>
<ul>
<li>
<h4><code><a title="ogr.services.pagure.pull_request.PagurePullRequest" href="#ogr.services.pagure.pull_request.PagurePullRequest">PagurePullRequest</a></code></h4>
<ul class="">
<li><code><a title="ogr.services.pagure.pull_request.PagurePullRequest.set_flag" href="#ogr.services.pagure.pull_request.PagurePullRequest.set_flag">set_flag</a></code></li>
</ul>
</li>
</ul>
</li>
</ul>
</nav>
</main>
<footer id="footer">
<p>Generated by <a href="https://pdoc3.github.io/pdoc" title="pdoc: Python API documentation generator"><cite>pdoc</cite> 0.10.0</a>.</p>
</footer>
</body>
</html>